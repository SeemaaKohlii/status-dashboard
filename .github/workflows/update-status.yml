name: Update Issues Dashboard

on:
  schedule:
    - cron: "0 * * * *"  # Runs every hour
  workflow_dispatch:  # Allows manual trigger

jobs:
  update-dashboard:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Ensures full commit history

      - name: Fetch All Open and Closed Issues from GitHub API
        run: |
          echo "Fetching all issues from GitHub API..."

          # Fetch Open Issues
          curl -s -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: Bearer ${{ secrets.PAT_TOKEN }}" \
            "https://api.github.com/repos/${{ github.repository }}/issues?state=open" \
            > open_issues.json

          # Fetch Closed Issues
          curl -s -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: Bearer ${{ secrets.PAT_TOKEN }}" \
            "https://api.github.com/repos/${{ github.repository }}/issues?state=closed" \
            > closed_issues.json

      - name: Process Issues Data
        run: |
          echo "Processing issues data..."

          jq -s '{ 
              open_issues:  map(.[0][]) | map({title: .title, url: .html_url, created_at: .created_at}),
              closed_issues: map(.[1][]) | map({title: .title, ur
